(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{132:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return l}));var a=n(1),r=n(6),i=(n(0),n(163)),o={title:"SubscriptionAction",description:"SubscriptionAction API reference for redux-requests - declarative AJAX requests and automatic network state management for single-page applications"},c={id:"api-reference/subscription-action",title:"SubscriptionAction",description:"SubscriptionAction API reference for redux-requests - declarative AJAX requests and automatic network state management for single-page applications",source:"@site/docs/api-reference/subscription-action.md",permalink:"/docs/api-reference/subscription-action",editUrl:"https://github.com/klis87/redux-requests/edit/master/docusaurus/docs/api-reference/subscription-action.md",lastUpdatedBy:"klis87",lastUpdatedAt:1613689620,sidebar:"docs",previous:{title:"RequestAction",permalink:"/docs/api-reference/request-action"},next:{title:"handleRequests",permalink:"/docs/api-reference/handle-requests"}},s=[{value:"<code>subscription</code>",id:"subscription",children:[]},{value:"<code>meta</code>",id:"meta",children:[{value:"<code>getData: data =&gt; transformedData</code>",id:"getdata-data--transformeddata",children:[]},{value:"<code>requestKey: string</code>",id:"requestkey-string",children:[]},{value:"<code>normalize: boolean</code>",id:"normalize-boolean",children:[]},{value:"<code>onMessage: (data, message, store) =&gt; void</code>",id:"onmessage-data-message-store--void",children:[]},{value:"<code>mutations</code>",id:"mutations",children:[]}]}],p={rightToc:s};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"SubscriptionAction")," is a type which defines the structure of subscription actions. Like\nall Redux actions it obviously has a ",Object(i.b)("inlineCode",{parentName:"p"},"type")," property. Also it must have ",Object(i.b)("inlineCode",{parentName:"p"},"subscription"),"\nproperty and might have ",Object(i.b)("inlineCode",{parentName:"p"},"meta")," property."),Object(i.b)("h2",{id:"subscription"},Object(i.b)("inlineCode",{parentName:"h2"},"subscription")),Object(i.b)("p",null,"This is mandatory key in any subscription action."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const onBookAdded = () => ({\n  type: 'ON_BOOK_ADDED',\n  subscription: {\n    type: 'ON_BOOK_ADDED',\n  },\n});\n")),Object(i.b)("p",null,"Just pass it whatever your websocket server needs to start the subscription. Then, it will be automatically send to your server.\nIf your server doesn't need any message to start the subscription, just pass ",Object(i.b)("inlineCode",{parentName:"p"},"null"),"."),Object(i.b)("h2",{id:"meta"},Object(i.b)("inlineCode",{parentName:"h2"},"meta")),Object(i.b)("p",null,"While ",Object(i.b)("inlineCode",{parentName:"p"},"subscription")," key is mandatory, ",Object(i.b)("inlineCode",{parentName:"p"},"meta")," is optional. As an example, let's add a ",Object(i.b)("inlineCode",{parentName:"p"},"meta")," property\nto ",Object(i.b)("inlineCode",{parentName:"p"},"ON_BOOK_ADDED")," action:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const onBookAdded = id => ({\n  type: 'ON_BOOK_ADDED',\n  subscription: {\n    type: 'ON_BOOK_ADDED',\n  },\n  meta: {\n    requestKey: id,\n  },\n});\n")),Object(i.b)("p",null,"which would allow having multiple and independent subscriptions for ",Object(i.b)("inlineCode",{parentName:"p"},"ON_BOOK_ADDED"),", per id."),Object(i.b)("p",null,"Below you can see the list of all possible ",Object(i.b)("inlineCode",{parentName:"p"},"meta")," options:"),Object(i.b)("h3",{id:"getdata-data--transformeddata"},Object(i.b)("inlineCode",{parentName:"h3"},"getData: data => transformedData")),Object(i.b)("p",null,"A function which is called on received messages, which allows you to transform data received from server."),Object(i.b)("h3",{id:"requestkey-string"},Object(i.b)("inlineCode",{parentName:"h3"},"requestKey: string")),Object(i.b)("p",null,"Allows you to have multiple independent subscriptions for the same type, per requestKey."),Object(i.b)("h3",{id:"normalize-boolean"},Object(i.b)("inlineCode",{parentName:"h3"},"normalize: boolean")),Object(i.b)("p",null,"Automatically normalize ",Object(i.b)("inlineCode",{parentName:"p"},"data")," from server messages. More information in\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"../tutorial/10-automatic-normalisation"}),"automatic normalisation tutorial"),"."),Object(i.b)("h3",{id:"onmessage-data-message-store--void"},Object(i.b)("inlineCode",{parentName:"h3"},"onMessage: (data, message, store) => void")),Object(i.b)("p",null,"Function which will be called on each received message from the server. It can be used for side-effects."),Object(i.b)("h3",{id:"mutations"},Object(i.b)("inlineCode",{parentName:"h3"},"mutations")),Object(i.b)("p",null,"An object to instruct a subscription how to update queries data. Its keys are just\nquery types and values are update functions, for example for ",Object(i.b)("inlineCode",{parentName:"p"},"ON_BOOK_ADDED")," subscription we could have:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"mutations: {\n  FETCH_BOOKS: (data, subscriptionData) => [...data, subscriptionData.addedBook],\n}\n")))}l.isMDXComponent=!0},163:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=r.a.createContext({}),l=function(e){var t=r.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},u=function(e){var t=l(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),b=a,m=u["".concat(o,".").concat(b)]||u[b]||d[b]||i;return n?r.a.createElement(m,c({ref:t},p,{components:n})):r.a.createElement(m,c({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=b;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var p=2;p<i;p++)o[p]=n[p];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);
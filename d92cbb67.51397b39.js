(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{149:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return l}));var r=n(1),a=n(6),o=(n(0),n(154)),s={title:"2. Batch requests",description:"2nd part of the tutorial for redux-requests - declarative AJAX requests and automatic network state management for Redux"},c={id:"tutorial/2-batch-requests",title:"2. Batch requests",description:"2nd part of the tutorial for redux-requests - declarative AJAX requests and automatic network state management for Redux",source:"@site/docs/tutorial/2-batch-requests.md",permalink:"/docs/tutorial/2-batch-requests",editUrl:"https://github.com/klis87/redux-requests/edit/master/docusaurus/docs/tutorial/2-batch-requests.md",lastUpdatedBy:"klis87",lastUpdatedAt:1595253322,sidebar:"docs",previous:{title:"1. Requests aborts",permalink:"/docs/tutorial/1-requests-aborts"},next:{title:"3. Request keys",permalink:"/docs/tutorial/3-request-keys"}},i=[{value:"What are batch requests?",id:"what-are-batch-requests",children:[]},{value:"Use cases for batch requests",id:"use-cases-for-batch-requests",children:[]}],u={rightToc:i};function l(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"what-are-batch-requests"},"What are batch requests?"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Batch requests")," is about sending multiple requests by dispatching a single request\naction (with array of request configs)."),Object(o.b)("h2",{id:"use-cases-for-batch-requests"},"Use cases for batch requests"),Object(o.b)("p",null,"Let's write a request action to fetch a book detail:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const FETCH_BOOK = 'FETCH_BOOK';\n\nconst fetchBook = id => ({\n  type: FETCH_BOOK,\n  request: {\n    url: `/books/${id}`,\n  },\n});\n")),Object(o.b)("p",null,"To make a request to get a book with id ",Object(o.b)("inlineCode",{parentName:"p"},"1"),", as you know from the previous part of the tutorial,\nyou just need to dispatch the request action:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"store.dispatch(fetchBook('1'));\n")),Object(o.b)("p",null,"You might be wondering, ok, so what if later I would like to get a book with id ",Object(o.b)("inlineCode",{parentName:"p"},"2"),"? Easy:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"store.dispatch(fetchBook('2'));\n")),Object(o.b)("p",null,"You need to know though that after response with book ",Object(o.b)("inlineCode",{parentName:"p"},"2")," is returned, the book with id ",Object(o.b)("inlineCode",{parentName:"p"},"1"),"\npreviously stored will be erased, as it will be just overwritten with book ",Object(o.b)("inlineCode",{parentName:"p"},"2")," data.\nThis is usually a good think, but what if you need to to have access to multiple books\nat the same time? Well, you could just create another request action:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const FETCH_ANOTHER_BOOK = 'FETCH_ANOTHER_BOOK';\n\nconst fetchAnotherBook = id => ({\n  type: FETCH_ANOTHER_BOOK,\n  request: {\n    url: `/books/${id}`,\n  },\n});\n")),Object(o.b)("p",null,"However, this would be a very inconvenient way. It would be also not scalable, what\nif you needed to have an access to 3 or even more books? So there is a better method,\nyou can use ",Object(o.b)("strong",{parentName:"p"},"batch requests"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const fetchBook = (id, anotherId) => ({\n  type: FETCH_BOOK,\n  request: [\n    { url: `/books/${id}` },\n    { url: `/books/${anotherId}` },\n  ],\n});\n")),Object(o.b)("p",null,"Notice that it is possible to pass an array of configs to ",Object(o.b)("inlineCode",{parentName:"p"},"request"),". Let's dispatch it:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"store.dispatch(fetchBook('1', '2'));\n")),Object(o.b)("p",null,"Above dispatch will actually send two requests, one for book ",Object(o.b)("inlineCode",{parentName:"p"},"1")," and second for book ",Object(o.b)("inlineCode",{parentName:"p"},"2"),".\nThose requests will be wrapped in ",Object(o.b)("inlineCode",{parentName:"p"},"Promise.all"),", so you will get either successful response\nwith data as array of all books data or just error response with the first encountered error."),Object(o.b)("p",null,"You can send any number of requests, but of course many of them could decrease performance.\nAnyway, we could refactor ",Object(o.b)("inlineCode",{parentName:"p"},"fetchBook")," function to handle any number of ids:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const fetchBook = ids => ({\n  type: FETCH_BOOK,\n  request: ids.map(id => ({ url: `/books/${id}` }),\n});\n")),Object(o.b)("p",null,"which could be used to get books with ids ",Object(o.b)("inlineCode",{parentName:"p"},"1")," to ",Object(o.b)("inlineCode",{parentName:"p"},"5")," like that:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"store.dispatch(fetchBook(['1', '2', '3', '4', '5']));\n")),Object(o.b)("p",null,"There is an alternative strategy to ",Object(o.b)("strong",{parentName:"p"},"batch requests")," which will be covered\nin the next part."))}l.isMDXComponent=!0},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=a.a.createContext({}),l=function(e){var t=a.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},b=function(e){var t=l(e.components);return a.a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=Object(r.forwardRef)((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),b=l(n),d=r,h=b["".concat(s,".").concat(d)]||b[d]||p[d]||o;return n?a.a.createElement(h,c({ref:t},u,{components:n})):a.a.createElement(h,c({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:r,s[1]=c;for(var u=2;u<o;u++)s[u]=n[u];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);